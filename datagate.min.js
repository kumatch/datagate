(function(){function b(){return b}function c(b,d){var e=c.resolve(b),f=c.modules[e];if(!f)throw new Error('failed to require "'+b+'" from '+d);return f.exports||(f.exports={},f.call(f.exports,f,f.exports,c.relative(e),a)),f.exports}var a=this;c.modules={},c.resolve=function(a){var b=a,d=a+".js",e=a+"/index.js";return c.modules[d]&&d||c.modules[e]&&e||b},c.register=function(a,b){c.modules[a]=b},c.relative=function(a){return function(d){if("debug"==d)return b;if("."!=d.charAt(0))return c(d);var e=a.split("/"),f=d.split("/");e.pop();for(var g=0;g<f.length;g++){var h=f[g];".."==h?e.pop():"."!=h&&e.push(h)}return c(e.join("/"),a)}},c.register("array.js",function(a,b,c,d){var e=c("./utils"),f=c("./error").ArrayError,g=e._,h=e.async;a.exports=function(a,b){return b===undefined&&(b="Invalid value in array."),function(c,d){var e=[],i=[];if(!g.isArray(c)){d(new f({message:b,origin:c,result:e,errors:i}),e);return}h.forEachSeries(c,function(b,c){typeof a=="function"?a(b,function(a,b){e.push(b),a&&i.push(a),c()}):(e.push(b),c())},function(a){if(i.length){var g=new f({message:b,origin:c,result:e,errors:i});d(g,e)}else d(null,e)})}}}),c.register("datagate.js",function(a,b,c,d){function i(a,b){b===undefined&&(b=function(a,b){return"Invalid value / origin: "+a+", result: "+b});var c=g.map(a,function(a){var c,d;g.isArray(a)?(c=a[0],d=a[1]||b):(c=a,d=b);if(!g.isFunction(c))throw Error("Invalid datagate filter.");return function(a,b,e){c(b,function(c,h){if(!c)e(null,a,h);else{var i=d;g.isFunction(d)&&(i=d(a,b)),e(new f({message:i,origin:a,result:b}))}})}});return function(a,b){var d=c.slice(0);d.unshift(function(b){b(null,a,a)}),h.waterfall(d,function(a,c,d){a?b(a,a.result):b(null,d)})}}var e=c("./utils"),f=c("./error").VariableError,g=e._,h=e.async;b=a.exports=i,b.array=c("./array"),b.object=c("./object"),b.union=c("./union"),b.filter=c("./filter"),b.validator=c("./validator")}),c.register("error.js",function(a,b,c,d){function f(a){Error.call(this),Error.captureStackTrace(this,arguments.callee),this.name="DatagateVariableError",this.message=a.message,this.origin=a.origin,this.result=a.result}function g(a){Error.call(this),Error.captureStackTrace(this,arguments.callee),this.name="DatagateArrayError",this.message=a.message,this.origin=a.origin,this.result=a.result,this.errors=a.errors,this.errors_message=k(this.errors)}function h(a){Error.call(this),Error.captureStackTrace(this,arguments.callee),this.name="DatagateObjectError",this.message=a.message,this.origin=a.origin,this.result=a.result,this.properties=a.properties,this.properties_message=j(this.properties)}function i(a){Error.call(this),Error.captureStackTrace(this,arguments.callee),this.name="DatagateUnionError",this.message=a.message,this.origin=a.origin,this.result=a.result,this.errors=a.errors,this.errors_message=k(this.errors)}function j(a){var b=e.keys(a),c=b.length,d={};for(var f=0;f<c;f++){var g=b[f],h=a[g];h.name==="DatagateObjectError"?d[g]=h.properties_message:h.name==="DatagateArrayError"?d[g]=h.errors_message:d[g]=h.message}return d}function k(a){return e.map(a,function(a){return a.name==="DatagateObjectError"?a.properties_message:a.name==="DatagateArrayError"||a.name==="DatagateUnionError"?a.errors_message:a.message})}var e=c("./utils")._;b.VariableError=f,b.ArrayError=g,b.ObjectError=h,b.UnionError=i,f.prototype=new Error,g.prototype=new Error,h.prototype=new Error,i.prototype=new Error}),c.register("filter.js",function(a,b,c,d){b.trim=function(a,b){typeof a=="string"&&a+""&&(a=String.prototype.trim.call(a)),b(null,a)},b.toLowerCase=function(a,b){typeof a=="string"&&a+""&&(a=String.prototype.toLowerCase.call(a)),b(null,a)},b.toUpperCase=function(a,b){typeof a=="string"&&a+""&&(a=String.prototype.toUpperCase.call(a)),b(null,a)},b.toStringType=function(a,b){b(null,a+"")},b.toNumberType=function(a,b){a===undefined||a===null||a===""?b(null,NaN):b(null,Number(a))},b.toBooleanType=function(a,b){!a||a==="0"||a===null||a===undefined?b(null,!1):b(null,!0)},b.replace=function(a,b){return function(c,d){typeof c=="string"&&c+""&&(c=String.prototype.replace.call(c,a,b)),d(null,c)}},b.toDefault=function(a){return function(b,c){b===undefined||b===null||b===""?c(null,a):c(null,b)}},b.custom=function(a){if(typeof a!="function")throw Error("Argument must be function in datagate custom filter.");return a}}),c.register("object.js",function(a,b,c,d){var e=c("./utils"),f=c("./error").ObjectError,g=e._,h=e.async;a.exports=function(a,b){b===undefined&&(b="Invalid object value.");var c=a?g.keys(a):[];return function(d,e){var i={},j={},k=!1;g.isObject(d)||(k=!0),h.forEach(c,function(b,c){var e=a[b],f=d?d[b]:undefined;e(f,function(a,d){i[b]=d,a&&(j[b]=a,k=!0),c()})},function(a){if(a)e(a);else if(k){var c=new f({message:b,origin:d,result:i,properties:j});e(c,i)}else e(null,i)})}}}),c.register("union.js",function(a,b,c,d){var e=c("./utils").async,f=c("./error").UnionError;a.exports=function(a,b){return b===undefined&&(b="Invalid value in union."),function(c,d){if(!a)return d(null,c);var g=[],h;e.forEachSeries(a,function(a,b){a(c,function(a,c){h=c,a?(g.push(a),b()):d(null,c)})},function(a){if(a)d(a);else{var e=new f({message:b,origin:c,result:h,errors:g});d(e,h)}})}}}),c.register("utils.js",function(a,b,c,d){typeof _!="undefined"&&_.VERSION?b._=_:b._=c("underscore"),typeof async!="undefined"?b.async=async:b.async=c("async"),b.chain=function(a,b){function c(d){if(d)b(d);else{var e=a.shift(),f=Array.prototype.slice.call(arguments);a.length>0?f=f.slice(1).concat(c):f=f.slice(1).concat(b),e.apply(null,f)}}c()}}),c.register("validator.js",function(a,b,c,d){var e=c("./utils")._,f={};a.exports=f;var g={NumberType:function(a,b){e.isNumber(a)?b(null,a):b(Error())},StringType:function(a,b){e.isString(a)?b(null,a):b(Error())},BooleanType:function(a,b){e.isBoolean(a)?b(null,a):b(Error())},FunctionType:function(a,b){e.isFunction(a)?b(null,a):b(Error())},ArrayType:function(a,b){e.isArray(a)?b(null,a):b(Error())},ObjectType:function(a,b){Object.prototype.toString.call(a)==="[object Object]"?b(null,a):b(Error())},DateType:function(a,b){e.isDate(a)?b(null,a):b(Error())},RegExpType:function(a,b){e.isRegExp(a)?b(null,a):b(Error())},Empty:function(a,b){a===null||a===undefined||a===""?b(null,a):b(Error())},Null:function(a,b){a===null?b(null,a):b(Error())},Undefined:function(a,b){a===undefined?b(null,a):b(Error())},NaN:function(a,b){e.isNaN(a)?b(null,a):b(Error())},Integer:function(a,b){(e.isNumber(a)||e.isString(a))&&(a+"").match(/^-?[0-9]+$/)?b(null,a):b(Error())},Alphabet:function(a,b){e.isString(a)&&(a+"").match(/^[a-zA-Z]+$/)?b(null,a):b(Error())},Alphanumeric:function(a,b){e.isString(a)&&(a+"").match(/^[a-zA-Z0-9]+$/)||e.isNumber(a)&&(a+"").match(/^[0-9]+$/)?b(null,a):b(Error())},Decimal:function(a,b){(e.isNumber(a)||e.isString(a))&&(a+"").match(/^\-?[0-9]+(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/)?b(null,a):b(Error())},Ascii:function(a,b){!e.isNaN(a)&&(e.isNumber(a)||e.isString(a))&&(a+"").match(/^[!-~]+$/)?b(null,a):b(Error())},Url:function(a,b){var c=/^(?:(?:ht|f)tp(?:s?)\:\/\/|~\/|\/)?(?:\w+:\w+@)?((?:(?:[\-\w\d{1-3}]+\.)+(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\.uk|ac\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2}))|((\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)(\.(\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)){3}))(?::[\d]{1,5})?(?:(?:(?:\/(?:[\-\w~!$+|.,=]|%[a-f\d]{2})+)+|\/)+|\?|#)?(?:(?:\?(?:[\-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[\-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[\-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[\-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?:#(?:[\-\w~!$ |\/.,*:;=]|%[a-f\d]{2})*)?$/;c.test(a)?b(null,a):b(Error())},Email:function(a,b){var c=/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/;c.test(a)?b(null,a):b(Error())},Date:function(a,b){var c=/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-[0-9]{2}$/,d=Date.parse(a);c.test(a)&&!e.isNaN(d)?b(null,a):b(Error())},Time:function(a,b){if(!e.isString(a)){b(Error());return}var c=/^(\d{2}):(\d{2}):(\d{2})$/,d=a.match(c);if(!d){b(Error());return}var f=d[1],g=d[2],h=d[3];f>=0&&f<24&&g>=0&&g<60&&h>=0&&h<60?b(null,a):b(Error())}};e.each(g,function(a,b){var c="is"+b,d="not"+b;f[c]=a,f[d]=function(b,c){a(b,function(a,d){a?c(null,b):c(Error())})}}),f.required=f.notUndefined,f.max=f.maximum=function(a){return function(b,c){f.isDecimal(b,function(d,e){d?c(d):parseFloat(b)>a?c(Error()):c(null,b)})}},f.min=f.minimum=function(a){return function(b,c){f.isDecimal(b,function(d,e){d?c(d):parseFloat(b)<a?c(Error()):c(null,b)})}},f.maxLength=function(a){return function(b,c){e.isString(b)&&b.length<=a?c(null,b):e.isNumber(b)&&!e.isNaN(b)&&(b+"").length<=a?c(null,b):c(Error())}},f.minLength=function(a){return function(b,c){e.isString(b)&&b.length>=a?c(null,b):e.isNumber(b)&&!e.isNaN(b)&&(b+"").length>=a?c(null,b):c(Error())}},f.isPattern=function(a){if(!e.isRegExp(a))throw Error("Argument must be regexp type in datagate pattern validator.");return function(b,c){a.test(b)?c(null,b):c(Error())}},f.notPattern=function(a){if(!e.isRegExp(a))throw Error("Argument must be regexp type in datagate pattern validator.");return function(b,c){a.test(b)?c(Error()):c(null,b)}},f.isIn=function(a){return function(b,c){e.indexOf(a,b)<0?c(Error()):c(null,b)}},f.notIn=function(a){return function(b,c){e.indexOf(a,b)<0?c(null,b):c(Error())}},f.custom=function(a){if(typeof a!="function")throw Error("Argument must be function in datagate custom validator.");return a}}),datagate=c("datagate")})();