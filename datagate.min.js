(function(){function e(a,e){e===undefined&&(e=function(a,b){return"Invalid value / origin: "+a+", result: "+b});var f=b.map(a,function(a){var c,f;b.isArray(a)?(c=a[0],f=a[1]||e):(c=a,f=e);if(!b.isFunction(c))throw Error("Invalid datagate filter.");return function(a,e,g){c(e,function(c,h){if(!c)g(null,a,h);else{var i=f;b.isFunction(f)&&(i=f(a,e)),g(new d.VariableError({message:i,origin:a,result:e}))}})}});return function(a,b){var d=f.slice(0);d.unshift(function(b){b(null,a,a)}),c.waterfall(d,function(a,c,d){a?b(a,a.result):b(null,d)})}}function f(a){Error.call(this),Error.captureStackTrace(this,arguments.callee),this.name="DatagateVariableError",this.message=a.message,this.origin=a.origin,this.result=a.result}function g(a){Error.call(this),Error.captureStackTrace(this,arguments.callee),this.name="DatagateArrayError",this.message=a.message,this.origin=a.origin,this.result=a.result,this.errors=a.errors,this.errors_message=k(this.errors)}function h(a){Error.call(this),Error.captureStackTrace(this,arguments.callee),this.name="DatagateObjectError",this.message=a.message,this.origin=a.origin,this.result=a.result,this.properties=a.properties,this.properties_message=j(this.properties)}function i(a){Error.call(this),Error.captureStackTrace(this,arguments.callee),this.name="DatagateUnionError",this.message=a.message,this.origin=a.origin,this.result=a.result,this.errors=a.errors,this.errors_message=k(this.errors)}function j(a){var c=b.keys(a),d=c.length,e={};for(var f=0;f<d;f++){var g=c[f],h=a[g];h.name==="DatagateObjectError"?e[g]=h.properties_message:h.name==="DatagateArrayError"?e[g]=h.errors_message:e[g]=h.message}return e}function k(a){return b.map(a,function(a){return a.name==="DatagateObjectError"?a.properties_message:a.name==="DatagateArrayError"||a.name==="DatagateUnionError"?a.errors_message:a.message})}var a=this,b=a._||require("underscore"),c=a.async||require("async"),d=e;typeof module!="undefined"&&module.exports?exports=module.exports=d:a.datagate=d,d.__DATAGATE__=!0,d.array=function(a,e){return e===undefined&&(e="Invalid value in array."),function(f,g){var h=[],i=[];if(!b.isArray(f)){g(new d.ArrayError({message:e,origin:f,result:h,errors:i}),h);return}c.forEachSeries(f,function(b,c){typeof a=="function"?a(b,function(a,b){h.push(b),a&&i.push(a),c()}):(h.push(b),c())},function(a){if(i.length){var b=new d.ArrayError({message:e,origin:f,result:h,errors:i});g(b,h)}else g(null,h)})}},d.object=function(a,e){e===undefined&&(e="Invalid object value.");var f=a?b.keys(a):[];return function(g,h){var i={},j={},k=!1;b.isObject(g)||(k=!0),c.forEach(f,function(b,c){var d=a[b],e=g?g[b]:undefined;d(e,function(a,d){i[b]=d,a&&(j[b]=a,k=!0),c()})},function(a){if(a)h(a);else if(k){var b=new d.ObjectError({message:e,origin:g,result:i,properties:j});h(b,i)}else h(null,i)})}},d.union=function(a,b){return b===undefined&&(b="Invalid value in union."),function(e,f){if(!a)return f(null,e);var g=[],h;c.forEachSeries(a,function(a,b){a(e,function(a,c){h=c,a?(g.push(a),b()):f(null,c)})},function(a){if(a)f(a);else{var c=new d.UnionError({message:b,origin:e,result:h,errors:g});f(c,h)}})}},d.VariableError=f,d.ArrayError=g,d.ObjectError=h,d.UnionError=i,f.prototype=new Error,g.prototype=new Error,h.prototype=new Error,i.prototype=new Error}).call(this),function(a){var b=this,c={};typeof module!="undefined"&&module.exports?module.exports.__DATAGATE__?module.exports.filter=c:module.exports=c:typeof b.datagate!="undefined"&&(b.datagate.filter=c),c.trim=function(a,b){typeof a=="string"&&a+""&&(a=String.prototype.trim.call(a)),b(null,a)},c.toLowerCase=function(a,b){typeof a=="string"&&a+""&&(a=String.prototype.toLowerCase.call(a)),b(null,a)},c.toUpperCase=function(a,b){typeof a=="string"&&a+""&&(a=String.prototype.toUpperCase.call(a)),b(null,a)},c.toStringType=function(a,b){b(null,a+"")},c.toNumberType=function(a,b){a===undefined||a===null||a===""?b(null,NaN):b(null,Number(a))},c.toBooleanType=function(a,b){!a||a==="0"||a===null||a===undefined?b(null,!1):b(null,!0)},c.replace=function(a,b){return function(c,d){typeof c=="string"&&c+""&&(c=String.prototype.replace.call(c,a,b)),d(null,c)}},c.toDefault=function(a){return function(b,c){b===undefined||b===null||b===""?c(null,a):c(null,b)}},c.custom=function(a){if(typeof a!="function")throw Error("Argument must be function in datagate custom filter.");return a}}.call(this),function(){var a=this,b=a._||require("underscore"),c={};typeof module!="undefined"&&module.exports?module.exports.__DATAGATE__?module.exports.validator=c:module.exports=c:typeof a.datagate!="undefined"&&(a.datagate.validator=c);var d={NumberType:function(a,c){b.isNumber(a)?c(null,a):c(Error())},StringType:function(a,c){b.isString(a)?c(null,a):c(Error())},BooleanType:function(a,c){b.isBoolean(a)?c(null,a):c(Error())},FunctionType:function(a,c){b.isFunction(a)?c(null,a):c(Error())},ArrayType:function(a,c){b.isArray(a)?c(null,a):c(Error())},ObjectType:function(a,b){Object.prototype.toString.call(a)==="[object Object]"?b(null,a):b(Error())},DateType:function(a,c){b.isDate(a)?c(null,a):c(Error())},RegExpType:function(a,c){b.isRegExp(a)?c(null,a):c(Error())},Empty:function(a,b){a===null||a===undefined||a===""?b(null,a):b(Error())},Null:function(a,b){a===null?b(null,a):b(Error())},Undefined:function(a,b){a===undefined?b(null,a):b(Error())},NaN:function(a,c){b.isNaN(a)?c(null,a):c(Error())},Integer:function(a,c){(b.isNumber(a)||b.isString(a))&&(a+"").match(/^-?[0-9]+$/)?c(null,a):c(Error())},Alphabet:function(a,c){b.isString(a)&&(a+"").match(/^[a-zA-Z]+$/)?c(null,a):c(Error())},Alphanumeric:function(a,c){b.isString(a)&&(a+"").match(/^[a-zA-Z0-9]+$/)||b.isNumber(a)&&(a+"").match(/^[0-9]+$/)?c(null,a):c(Error())},Decimal:function(a,c){(b.isNumber(a)||b.isString(a))&&(a+"").match(/^\-?[0-9]+(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/)?c(null,a):c(Error())},Ascii:function(a,c){!b.isNaN(a)&&(b.isNumber(a)||b.isString(a))&&(a+"").match(/^[!-~]+$/)?c(null,a):c(Error())},Url:function(a,b){var c=/^(?:(?:ht|f)tp(?:s?)\:\/\/|~\/|\/)?(?:\w+:\w+@)?((?:(?:[\-\w\d{1-3}]+\.)+(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\.uk|ac\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2}))|((\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)(\.(\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)){3}))(?::[\d]{1,5})?(?:(?:(?:\/(?:[\-\w~!$+|.,=]|%[a-f\d]{2})+)+|\/)+|\?|#)?(?:(?:\?(?:[\-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[\-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[\-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[\-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?:#(?:[\-\w~!$ |\/.,*:;=]|%[a-f\d]{2})*)?$/;c.test(a)?b(null,a):b(Error())},Email:function(a,b){var c=/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/;c.test(a)?b(null,a):b(Error())},Date:function(a,c){var d=/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-[0-9]{2}$/,e=Date.parse(a);d.test(a)&&!b.isNaN(e)?c(null,a):c(Error())},Time:function(a,c){if(!b.isString(a)){c(Error());return}var d=/^(\d{2}):(\d{2}):(\d{2})$/,e=a.match(d);if(!e){c(Error());return}var f=e[1],g=e[2],h=e[3];f>=0&&f<24&&g>=0&&g<60&&h>=0&&h<60?c(null,a):c(Error())}};b.each(d,function(a,b){var d="is"+b,e="not"+b;c[d]=a,c[e]=function(b,c){a(b,function(a,d){a?c(null,b):c(Error())})}}),c.required=c.notUndefined,c.max=c.maximum=function(a){return function(b,d){c.isDecimal(b,function(c,e){c?d(c):parseFloat(b)>a?d(Error()):d(null,b)})}},c.min=c.minimum=function(a){return function(b,d){c.isDecimal(b,function(c,e){c?d(c):parseFloat(b)<a?d(Error()):d(null,b)})}},c.maxLength=function(a){return function(c,d){b.isString(c)&&c.length<=a?d(null,c):b.isNumber(c)&&!b.isNaN(c)&&(c+"").length<=a?d(null,c):d(Error())}},c.minLength=function(a){return function(c,d){b.isString(c)&&c.length>=a?d(null,c):b.isNumber(c)&&!b.isNaN(c)&&(c+"").length>=a?d(null,c):d(Error())}},c.isPattern=function(a){if(!b.isRegExp(a))throw Error("Argument must be regexp type in datagate pattern validator.");return function(b,c){a.test(b)?c(null,b):c(Error())}},c.notPattern=function(a){if(!b.isRegExp(a))throw Error("Argument must be regexp type in datagate pattern validator.");return function(b,c){a.test(b)?c(Error()):c(null,b)}},c.isIn=function(a){return function(c,d){b.indexOf(a,c)<0?d(Error()):d(null,c)}},c.notIn=function(a){return function(c,d){b.indexOf(a,c)<0?d(null,c):d(Error())}},c.custom=function(a){if(typeof a!="function")throw Error("Argument must be function in datagate custom validator.");return a}}.call(this);